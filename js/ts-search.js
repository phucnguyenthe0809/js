function sf_addItem(e,a,l,s,t){var i=$(e).find(".live-search_ajaxy-selective-item"),c=!1,r="",o=t.split(":");if(r=2==o.length?o[0]:t,i.length>0)for(var n=0;n<i.length;n++)if($(i[n]).find("input.live-search_ajaxy-selective-close-hidden").val()==r){c=!0;break}if(c)return $(e).find(".live-search_ajaxy-selective-input").val(""),void $("#live-search_sb").hide();2==a.split(":").length&&(a=o[1]);var h=$('<span class="live-search_ajaxy-selective-item">'+a+'<a class="live-search_ajaxy-selective-close">X</a><input class="live-search_ajaxy-selective-close-hidden" type="hidden" name="'+l+'" value="'+r+'" /></span>');i.length<=0?$(e).prepend(h):h.insertAfter(i[i.length-1]),h.click(function(){$(this).remove()});var v=$(e).find(".live-search_ajaxy-selective-input");v&&(v.val(""),"array"!=s?v.css("visibility","hidden"):v.focus()),$("#live-search_sb").hide()}!function(e){e.fn.extend({ajaxyLiveSearch:function(a,l){a=a&&"object"==typeof a?e.extend({},e.ajaxyLiveSearch.defaults,a):e.ajaxyLiveSearch.defaults,this.is("input")&&this.each(function(){new e.ajaxyLiveSearch.load(this,a,l)})}}),e.ajaxyLiveSearch={element:null,timeout:null,options:null,load:function(a,l,s){this.element=a,this.timeout=null,this.options=l,""==e(a).val()&&e(a).val(l.text),e(a).attr("autocomplete","off"),0==e("#live-search_sb").length&&e("body").append('<div id="live-search_sb" class="live-search_sb" style="position:absolute;display:none;width:'+l.width+'px;z-index:9999"><div class="live-search_sb_cont"><div class="live-search_sb_top"></div><div id="live-search_results" style="width:100%"><div id="live-search_val" ></div><div id="live-search_more"></div></div><div class="live-search_sb_bottom"></div></div></div>'),e.ajaxyLiveSearch.loadEvents(this)},loadResults:function(a){if(options=a.options,elem=a.element,window.sf_lastElement=elem,""!=e(elem).val()){e("body").data("live-search_results",null);var l='<li class="live-search_lnk live-search_more live-search_selected"><a id="live-search_loading" href="'+options.searchUrl.replace("%s",encodeURI(e(elem).val()))+'"><i class="fa fa-spinner fa-spin"></i></a></li>';e("#live-search_val").html("<ul>"+l+"</ul>");var s=this.bounds(elem,options),t=this.bounds(".searchx",options);if(!s)return e("#live-search_sb").hide(),!1;Math.ceil(t.left)+parseInt(options.width,10)>e(window).width()&&e("#live-search_sb").css("width",e(window).width()-t.left-20),e("body").hasClass("rtl")?e("#live-search_sb").css({top:s.bottom,right:t.right}):e("#live-search_sb").css({top:s.bottom,left:t.left}),e("#live-search_sb").show();var i={action:"ts_ac_do_search",ts_ac_query:e(elem).val()};if(options.ajaxData&&(i=window[options.ajaxData](i)),options.search){var c,r=options.search.split(","),o=[],n="",h=0;for(var v in r){var d=r[v].split(":");2==d.length?0==d[1].indexOf(e(elem).val())&&(o[o.length]=r[v]):1==d.length&&0==r[v].indexOf(e(elem).val())&&(o[o.length]=r[v])}n+=(c=e.ajaxyLiveSearch.htmlArrayResults(o))[0];var u="";0==(h+=c[1])&&(u=" live-search_selected"),n=(n=(n=(n=(n+='<li class="live-search_lnk live-search_more'+u+'">{total} </li>').replace(/{search_value_escaped}/g,e(elem).val())).replace(/{search_url_escaped}/g,options.searchUrl.replace("%s",encodeURI(e(elem).val())))).replace(/{search_value}/g,e(elem).val())).replace(/{total}/g,h),e("body").data("live-search_results",o),e("#live-search_val").html("<ul>"+n+"</ul>"),e.ajaxyLiveSearch.loadLiveEvents(a),e("#live-search_sb").show()}else jQuery.post(options.ajaxUrl,i,function(l){var s=l,t="",i=0;for(var c in s){var r=[];for(var o in s[c])t+=(r=e.ajaxyLiveSearch.htmlResults(s[c][o],c,o))[0],i+=r[1]}0==i?(" live-search_selected",t+='<li class="live-search_lnk live-search_more"></li>'):(options.callback||(t+='<li class="live-search_lnk live-search_more">'+sf_templates+"</li>"),t=(t=t.replace(/{search_value_escaped}/g,e(elem).val())).replace(/{search_url_escaped}/g,options.searchUrl.replace("%s",encodeURI(e(elem).val())))),e("body").data("live-search_results",s),e("#live-search_val").html('<ul class="live-search_main">'+t+"</ul>"),e.ajaxyLiveSearch.loadLiveEvents(a),e("#live-search_sb").show()})}else e("#live-search_sb").hide()},bounds:function(a,l){var s=e(a).offset();if(s)return{top:s.top,left:s.left+l.leftOffset,bottom:s.top+e(a).innerHeight()+l.topOffset,right:s.left-e("#live-search_sb").innerWidth()+e(a).innerWidth()}},htmlResults:function(a,l,s){var t="",i=0;if(void 0!==a&&a.all.length>0){t+='<li class="live-search_header">'+a.title+'</li><li><div class="live-search_result_container"><ul>';for(var c=0;c<a.all.length;c++)i++,t+="<li result-type='object' index-type='"+l+"' index-array='"+s+"' index='"+c+"' class=\"live-search_lnk "+a.class_name+'">'+e.ajaxyLiveSearch.replaceResults(a.all[c],a.template)+"</li>";t+="</ul></div></li>"}return new Array(t,i)},htmlArrayResults:function(e){var a="",l=0;if(void 0!==e&&e.length>0){a+='<li><div class="live-search_result_container"><ul>';for(var s=0;s<e.length;s++){var t=e[s].split(":");l++,a+="<li result-type='array' index='"+s+"' class=\"live-search_lnk live-search_category\"><a href='javascript:;'>"+(2==t.length?t[1]:e[s])+"</a></li>"}a+="</ul></div></li>"}return new Array(a,l)},replaceResults:function(e,a){for(var l in e)a=a.replace(new RegExp("{"+l+"}","g"),e[l]);return a},loadLiveEvents:function(a){var l={object:a};e("#live-search_val li.live-search_lnk").mouseover(function(){e(".live-search_lnk").each(function(){e(this).attr("class",e(this).attr("class").replace(" live-search_selected",""))}),e(this).attr("class",e(this).attr("class")+" live-search_selected")}),l.object.options.callback&&e("#live-search_val li.live-search_lnk").click(function(e){try{window[l.object.options.callback](l.object,this)}catch(e){alert(e)}return!1})},loadEvents:function(a){var l={object:a};e(document).click(function(){e("#live-search_sb").hide()}),e(window).resize(function(){var a=e.ajaxyLiveSearch.bounds(window.sf_lastElement,l.object.options);a&&e("#live-search_sb").css({top:a.bottom,left:a.left})}),e(a.element).keyup(function(a){if("38"!=a.keyCode&&"40"!=a.keyCode&&"13"!=a.keyCode&&"27"!=a.keyCode&&"39"!=a.keyCode&&"37"!=a.keyCode){var s=l.object;null!=s.timeout&&clearTimeout(s.timeout),e(s.element).attr("class",e(s.element).attr("class").replace(" live-search_focused","")+" live-search_focused");var t={object:l.object};s.timeout=setTimeout(function(){jQuery.ajaxyLiveSearch.loadResults(t.object)},l.object.options.delay)}}),e(window).keydown(function(a){if("none"!=e("#live-search_sb").css("display")&&"undefined"!=e("#live-search_sb").css("display")&&e("#live-search_sb").length>0)if("38"==a.keyCode||"40"==a.keyCode){jQuery.browser.webkit&&e("#live-search_sb").focus();var s=!1,t=e("#live-search_val li.live-search_lnk"),i=!1;a.stopPropagation(),a.preventDefault();for(var c=0;c<t.length;c++)e(t[c]).attr("class").indexOf("live-search_selected")>=0&&0==i?(s=!0,c<t.length-1&&"40"==a.keyCode?(e(t[c]).attr("class",e(t[c]).attr("class").replace(" live-search_selected","")),e(t[c+1]).attr("class",e(t[c+1]).attr("class")+" live-search_selected"),c+=1,i=!0):c>0&&"38"==a.keyCode&&(e(t[c]).attr("class",e(t[c]).attr("class").replace(" live-search_selected","")),e(t[c-1]).attr("class",e(t[c-1]).attr("class")+" live-search_selected"),c+=1,i=!0)):e(t[c]).attr("class",e(t[c]).attr("class").replace(" live-search_selected",""));0==s&&t.length>0&&e(t[0]).attr("class",e(t[0]).attr("class")+" live-search_selected")}else if(27==a.keyCode)e("#live-search_sb").hide();else if(13==a.keyCode){var r=e("#live-search_val li.live-search_selected a").attr("href");return void 0!==r&&""!=r?(l.object.options.callback?l.object.options.callback(this):window.location.href=r,!1):(l.object.options.callback?l.object.options.callback(this):null!=l.object.element&&(window.location.href=sf_url.replace("%s",encodeURI(e(l.object).val()))),!1)}}),e(a.element).focus(function(){e(this).val()==l.object.options.text&&(e(this).val(""),e(this).attr("class",e(this).attr("class")+" live-search_focused")),l.object.options.expand>0&&e(l.object.element).animate({width:l.object.options.iwidth})}),e(a.element).blur(function(){""==e(this).val()&&(e(this).val(l.object.options.text),e(this).attr("class",e(this).attr("class").replace(/ sf_focused/g,""))),l.object.options.expand>0&&e(l.object.element).animate({width:l.object.options.expand})})}},e.ajaxyLiveSearch.defaults={delay:500,leftOffset:0,topOffset:5,text:"Search For",iwidth:180,width:215,ajaxUrl:"",ajaxData:!1,searchUrl:"",expand:!1,callback:!1,search:!1}}(jQuery);
